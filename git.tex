\documentclass[11pt, oneside]{article}   	% use "amsart" instead of "article" for AMSLaTeX format
\usepackage{geometry}                		% See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   		% ... or a4paper or a5paper or ... 
%\geometry{landscape}                		% Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    		% Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}				% Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
								% TeX will automatically convert eps --> pdf in pdflatex		
\usepackage{amssymb}
\usepackage{amsmath}

\title{Lambert $W$'s Taylor Series}
\author{Akiva}
\date{}							% Activate to display a given date or no date

\begin{document}
\maketitle
%\section{}
%\subsection{}
The Lambert $W$ function is defined as the inverse of $xe^x$. That is:
$$y=W(x)\iff x=ye^y$$
It turns out that this has a nice Taylor series:
$$W(x)=\sum_{k=1}^\infty\frac{(-k)^{k-1}}{k!}x^k$$
We will derive this, and we'll take a slightly unusual path to get there.\\

Taylor's theorem is:
$$f(x)=\sum_{k=0}^\infty f^{(k)}(a)\frac{(x-a)^k}{k!}$$

I could use this theorem directly on $W(x)$, but that involves differentiating $W(x)$ a bunch of times and seeing if I can find a pattern. That's really messy. I'll use a more interesting approach.

In fact, I'll only need to use this theorem on polynomials. This avoids issues of convergence; for polynomials, the Taylor series is really a finite sum, because if $k$ is large enough, then $f^{(k)}=0$. (Also, Taylor's theorem is much easier to prove for polynomials than for general functions.)

Let's make a useful change of notation. Instead of writing $f'$ for the derivative of $f$, let's write $Df$. (Here, $D$ is an \textit{operator} -- it turns a function into a function.) Additionally, $\dfrac{x^k}{k!}$ is \textit{such} an important polynomial that I'll give it a special name: $d_k(x):=\dfrac{x^k}{k!}$. Note that:
\begin{itemize}
\item $Dd_k=d_{k-1}$
\item $d_k(0)=0$ (when $k\ne0$)
\item $d_0=1$
\end{itemize}
$d_k$ is called the \textit{basic sequence} of $D$.

Our revised Taylor series looks like:
$$f(x)=\sum_{k=0}^\infty (D^kf)(a)\;d_k(x-a)$$

We can add together operators. For example, $D+D^2$ is the operator such that $(D+D^2)f=f'+f''$. $I$ is the identity operator, i.e., that $If=f$ for every function $f$. We have $D^0=I$.

In addition, we can do weird things such as find $e^D$ -- since $e^x=\sum_{k=0}^\infty\frac{x^k}{k!}$, we can define $e^D$ to mean $\sum_{k=0}^{\infty}\frac{D^k}{k!}$.

Define the operator $E$ as follows: $(Ef)(x)=f(x+1)$. That is, $E$ shifts $f$ over one. More generally, $(E^af)(x)=f(x+a)$. A nice fact is that $DE=ED$ (that is, they commute). We will now prove that $E=e^D$.

Start with the Taylor series, and substitute $x\mapsto x+1$ and $a\mapsto x$:
\begin{align*}
f(x+1)&=\sum_{k=0}^\infty (D^kf)(x)\;d_k(x+1-x)\\
f(x+1)&=\sum_{k=0}^\infty (D^kf)(x)\;d_k(1)\\
(Ef)(x)&=\sum_{k=0}^\infty\frac{(D^kf)(x)}{k!}\\
E&=\sum_{k=0}^\infty\frac{D^k}{k!}\\
E&=e^D
\end{align*}\\

Define the \textit{Abel operator} $A:=DE$. That is, $(Af)(x)=f'(x+1)$. By the above theorem, $A=De^D$. We have $A$ written in terms of $D$. Can we express $D$ in terms of $A$? That is, can we find the coefficients $c_k$ of the series:
$$D=\sum_{k=0}^\infty c_kA^k$$

And this is where this ties into the Lambert $W$ function. Since $W(x)$ is the inverse of $xe^x$, and $A=De^D$, we have $D=W(A)$. That means the same coefficients $c_k$ will be the coefficients of the series for $W(x)$.\\

This is a variant of Taylor's theorem, and is equally true:
$$f(x)=\sum_{k=0}^\infty (A^kf)(a)\;a_k(x-a)$$
where $a_k$ is the basic sequence for $A$ -- that is, $Aa_k=a_{k-1}$, $a_k(0)=0$ when $k\ne0$, and $a_0=1$. We will figure out what the $a_k$ are later. Basically, this is the Taylor sequence with all of the $D$s replaced by $A$s. Again, $f$ only needs to be a polynomial. (The proof of this is similar to how you'd prove Taylor's theorem for polynomials.)

Differentiating:
$$(Df)(x)=\sum_{k=0}^\infty(A^kf)(a)\;a_k'(x-a)$$
Set $a=x$:
\begin{align*}
(Df)(x)&=\sum_{k=0}^\infty(A^kf)(x)\;a_k'(0)\\
(Df)(x)&=\sum_{k=0}^\infty\;a_k'(0)\;(A^kf)(x)\\
D&=\sum_{k=0}^\infty a_k'(0)A^k
\end{align*}

This means that the coefficients of the Lambert $W$ function are precisely $a_k'(0)$, where $a_k$ is the basic sequence of $A$ !

So, what are the $a_k$? Let's list the first few and see if we find a pattern. Remember that $A=DE$. Also, $Aa_k=a_{k-1}$, $a_k(0)=0$ when $k\ne0$, and $a_0=1$. So:
\begin{itemize}
\item $a_0(x)=1$
\item $a_1(x)=(x-1)+1$

I'm writing this in a slightly weird way. Think of it as me doing $A$ backwards, by integrating $a_0$ and then shifting it. We have $Aa_1=a_0$. The $1$ is to ensure that $a_1(0)=0$.
\item $a_2(x)=\dfrac{(x-2)^2}2+(x-2)$

It's easy to check that $Aa_2=a_1$. We have $a_2(0)=\frac42-2=0$.
\item $a_3(x)=\dfrac{(x-3)^3}{3!}+\dfrac{(x-3)^2}{2!}$

We check that $a_3(0)=-\frac{27}6+\frac 92=0$
\end{itemize}
Generalizing the pattern, we have:
$$a_k(x)=\dfrac{(x-k)^k}{k!}+\dfrac{(x-k)^{k-1}}{(k-1)!}$$
(except for $k=0$, where $a_k=1$). The three conditions for $a_k$ are satisfied, as you can check.

Now, all we need to do is compute $a_k'(0)$:
\begin{align*}
a_k'(x)&=\frac{(x-k)^{k-1}}{(k-1)!}+\frac{(x-k)^{k-2}}{(k-2)!}\\
&=\left(\frac{(x-k)^{k-2}}{(k-1)!}\right)((x-k)+(k-1))\\
&=\left(\frac{(x-k)^{k-2}}{(k-1)!}\right)(x-1)\\
a_k'(0)&=\frac{(-k)^{k-2}}{(k-1)!}(-1)\\
&=\frac{(-k)^{k-2}}{(k-1)!}\frac{(-k)}{k}\\
&=\frac{(-k)^{k-1}}{k!}
\end{align*}
(except for $k=0$, where $a_k'(0)=0$).

That means that, by our above result:
$$D=\sum_{k=1}^\infty\frac{(-k)^{k-1}}{k!}A^k$$
and, thus:
$$W(x)=\sum_{k=1}^\infty\frac{(-k)^{k-1}}{k!}x^k$$
And we are done.
\end{document}
